---
sidebar_position: 3
sidebar_label: "with Azure"
draft: true
---

# SAML with Azure

:::info This is a Supplementry Guide
This guide supplements the [Configuring your IdP server](./saml2#configuring-the-idp) portion of the [Configuring SAML 2.0](./saml2) docs using Azure as your identity provider (IdP). Please ensure you've already read and understand the concepts in the [Configuring SAML 2.0](./saml2) documentation before continuing.
:::

:::note Do you already have an Azure account?
This guide assumes you have already configured your Azure account and have access to the Azure portal. If you have not, please refer to the [Azure documentation](https://docs.microsoft.com/en-us/azure/active-directory/saas-apps/tutorial-list).
:::

### Enable single sign-on for an app
To set up single sign-on for an application:
1. In the Azure AD portal, select Enterprise applications. Then, click Create your Own Application
2. Give it a name and then select the "integrate any other application..." option and create
3. In the Manage section, select Single sign-on to open the Single sign-on pane for editing.

### Upload the SP (IE) Metadata File

![](https://lh4.googleusercontent.com/nzv9jt5cu1SA0vGd3NXPsD0FO0iQU31nuMVVwes4pvdsampoOIJLwXiaYnUcQ45DSgFoMimEJv2yeyUDwZ0vlwj0dvYFxJCzI02txQiOHyQ-6dsPk7I7OcYWShNV4SNMHw=w1280)

Upload the metadata file you received from IE and this will auto populate most of the SAML configuration that you'll need.
:::note
If uploading an XLM file (instead of utilizing a live hosted URL), remove the validUntil property and value.
:::

![](https://lh5.googleusercontent.com/jiJCdk8e_9SrzxkYA1j9DTZAY_Qpk8uup3AmeT3dXlZZkM2VETQe5Es6i0cYv9Ob_gLaZrFIkjvRdCybk1VD3Ock6q_ovJA3PX3SLAymDzI0d8Xx=w1280)

**Azure Docs for SAML Claim Customization:** [https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-saml-claims-customization](https://www.google.com/url?q=https%3A%2F%2Fdocs.microsoft.com%2Fen-us%2Fazure%2Factive-directory%2Fdevelop%2Factive-directory-saml-claims-customization&sa=D&sntz=1&usg=AOvVaw3zKihiR2Wd5b37eo2bUewL)

### Edit/Add User Attributes and Claims
This is how Azure will know what to send along with the User authentication via SAML

:::info important
Please refer to the [SAML 2.0 documentation](./saml2#configure-attributes) for requirements and recommendations regarding attributes and claims.
:::

#### How to Add a New Claim:
1.  Click "Add New Claim" to bring up the manage claim dialog.
2.  Give the claim an identifying name
3.  Namespace can be the attribute name, otherwise we're able to match whatever namespace you enter here.
4.  Source should be Attribute.
5.  Source attribute is the key matching the user value you'd like to include.

![](https://lh5.googleusercontent.com/LUsbk1dPjkNAQB1XD2L4r0lpphVsmn19e6HUdwPj0flz5SdDOlc128srQ_QN0_v_aMu0KJpVsb3BxXdWF_GFPos7zUOnbU7bkeuGAp6F_eKZn7Pr=w1280)

#### Add licenseId as a Claim (Static Attribute)
1.  Perform the same steps as above say for the last one
2.  In the Source Attribute field, add the license Id (provided by IE) in plain text instead of matching an already defined attribute key. You'll know it's a static value if Azure surrounds it in quotes.

### Configuring the NameId (Name Identifier)
The Name Identifier is the unique ID that will identify SAML users coming from the IdP (identity provider).

:::info Important
[Please refer to the SAML 2.0 documentation for requirements and recommendations regarding the NameID](./saml2#external-customer-id).
:::

**In Azure, the NAME_ID attribute/claim looks like this:**

![](https://lh6.googleusercontent.com/uZhhow_mK6K6vgi1Jei_H7xc13lRL_56ojoXHLF87GKjRNyiq4cPkoI3mOy-R-rwzmgauyk4qBgnxESCNkcBHDAzJctiOV641bOcmtVdc3JAf1Yk=w1280)

#### Making the NameID unique

1. Start by editing the Name Identifier Value attribute and changing the **source** to **Transformation** by selecting the radio button

![](https://lh4.googleusercontent.com/aBACTNE7EOKdzhq7TwlMnngvvHg66fmKgFlat40ksy3yQOMUx2lstlCwmPStNAFIfm-JmuSc9WgymWrDslwRh29ECC6Bix0tFkKlSyznw9vklVQBLNfS-5Ysfv6pOXffNQ=w1280)

2. Then set the **Transformation** to **Join()**, the **Parameter 1** to the **unique-to-your-institution ID**, and **Parameter 2** to the static value of the **@ symbol** and your **domain name** like below.

:::note
Azure will put your string in quotes (like the licenseId above) if it recognizes your input as a static value.
:::

![](https://lh3.googleusercontent.com/latRLZhe2DGgPAczRk3ZHamU34tR1Sk0U4qpjiIQAZwBu1C-IC8fyhugMRk-wZc2JVkeXu7K8ml55KflMlF7fPsJdv74h9ugF67jOnZNgXf9wXZIWwy5swQBJo-KvJDDBw=w1280)

3. Then click save and you're all set!